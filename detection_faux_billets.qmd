---
title: "detection_faux_billets"
format: pdf
editor: visual
---

## 1- Chargement du modèle de prédictions

```{r}
options(repos = c(CRAN = "https://cran.rstudio.com/"))
```

### a- Modèle de régression Logistique

```{r}
# Charger le modèle ajusté et le seuil optimal
reg_log_model <- readRDS("modele_regression_logistique.rds")
best_threshold <- readRDS("seuil_optimal.rds")
```

```{r}
best_threshold
```

Le Seuil optimal offrant la meilleur spécificité, c'est à dire le moins de risque de faux positifs était 0.97 dans notre modèle.

## 2- Chargement des datas

```{r}
data <- read.csv("data_raw/billets_test (4).csv", sep =",")
```

## 3- Contrôle et préparation des datas

```{r}
head(data)
```

On extrait id pour ne conserver que les valeurs numériques et on stock pour pouvoir identifier les billets après application du modèle de prédiction.

```{r}
# Extraire la colonne 'id' pour référence
ids <- data$id
```

```{r}
# Supprimer la colonne 'id' avant de faire des prédictions
new_data <- data[, -which(names(data) == "id")]
```

## 4- Application du modèle de régression logistique sur le jeu de données

```{r}
# Faire des prédictions de probabilités sur de nouvelles données
predicted_prob <- predict(reg_log_model, new_data, type = "response")
```

```{r}
# Appliquer le seuil optimal pour classer les probabilités
predictions <- ifelse(predicted_prob > best_threshold, "True", "False")
```

```{r}
# Afficher les prédictions
print(predictions)
```

```{r}
table(predictions)
```

```{r}
# Association des identifiants de billets avec les prédictions
resultat <- data.frame(id = ids, is_genuine = predictions, proba = round(predicted_prob*100,5))

print(resultat)
```
